<header class="isp-header">
  <div class="isp-header-grid">
    <div class="isp-header-left">
      <div class="isp-header-org">Deutsche Bahn AG</div>
      {% if department %}<div class="isp-header-dept">{{ department }}</div>{% endif %}
      <div class="isp-header-meta">
        <span class="doc-type">{{ doc_type|default('Dokument') }}</span>
        {% if doc_number %}<span class="doc-number">Nr. {{ doc_number }}</span>{% endif %}
      </div>
    </div>
    <div class="isp-header-center">
      {% if title %}<h1 class="isp-header-title">{{ title }}</h1>{% endif %}
    </div>
    <div class="isp-header-right">
      {% if logo_base64 %}
      <div class="isp-logo-container"><img src="data:image/svg+xml;base64,{{ logo_base64 }}" style="width:40mm;height:auto;" alt="DB Logo"/></div>
      {% else %}
      <div class="isp-logo-container"><div class="isp-logo-placeholder"><span class="logo-text">DB</span></div></div>
      {% endif %}
      <div class="isp-header-date">{{ doc_date }}</div>
    </div>
  </div>
  <div class="isp-header-accent"></div>
</header>
<style>
<header class="isp-header">
  <div class="isp-header-grid">
    <div class="isp-header-left">
      <div class="isp-header-org">Deutsche Bahn AG</div>
      {% if department %}<div class="isp-header-dept">{{ department }}</div>{% endif %}
      <div class="isp-header-meta">
        <span class="doc-type">{{ doc_type|default('Dokument') }}</span>
        {% if doc_number %}<span class="doc-number">Nr. {{ doc_number }}</span>{% endif %}
      </div>
    </div>
    <div class="isp-header-center">
      {% if title %}<h1 class="isp-header-title">{{ title }}</h1>{% endif %}
    </div>
    <div class="isp-header-right">
      {% if logo_base64 %}
      <div class="isp-logo-container"><img src="data:image/svg+xml;base64,{{ logo_base64 }}" style="width:40mm;height:auto;" alt="DB Logo"/></div>
      {% else %}
      <div class="isp-logo-container"><div class="isp-logo-placeholder"><span class="logo-text">DB</span></div></div>
      {% endif %}
      <div class="isp-header-date">{{ doc_date }}</div>
    </div>
  </div>
  <div class="isp-header-accent"></div>
</header>
<style>
.isp-header { width: 100%; margin-bottom: 6mm; }
.isp-header-grid { display: flex; justify-content: space-between; align-items: flex-start; padding-bottom: 3mm; }
.isp-header-left { flex: 1; }
.isp-header-org { font-size: 11pt; font-weight: bold; color: #1E1E1E; margin-bottom: 1mm; }
.isp-header-dept { font-size: 9pt; color: #646464; margin-bottom: 2mm; }
.isp-header-meta { font-size: 8pt; color: #878787; }
.isp-header-meta .doc-type { font-weight: bold; color: #EC0016; margin-right: 3mm; }
.isp-header-meta .doc-number { font-family: Consolas, monospace; }
.isp-header-center { flex: 2; text-align: center; }
.isp-header-title { font-size: 14pt; font-weight: bold; color: #EC0016; margin: 0; }
.isp-header-right { flex: 1; text-align: right; }
.isp-logo-container { margin-bottom: 2mm; }
.isp-logo-placeholder { display: inline-block; width: 40mm; height: 10mm; background: linear-gradient(135deg, #EC0016 0%, #C50014 100%); border-radius: 2px; text-align: center; line-height: 10mm; }
.isp-logo-placeholder .logo-text { font-size: 16pt; font-weight: bold; color: #FFFFFF; letter-spacing: 2pt; }
.isp-header-date { font-size: 9pt; color: #646464; }
.isp-header-accent { height: 3pt; background: linear-gradient(90deg, #EC0016 0%, #EC0016 70%, transparent 100%); margin-top: 2mm; }
</style>
